{"remainingRequest":"X:\\web-homework\\lesson 11\\frontend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!X:\\web-homework\\lesson 11\\frontend\\src\\App.vue?vue&type=script&lang=js&","dependencies":[{"path":"X:\\web-homework\\lesson 11\\frontend\\src\\App.vue","mtime":1639655244865},{"path":"X:\\web-homework\\lesson 11\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1639605104435},{"path":"X:\\web-homework\\lesson 11\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":1639605107785},{"path":"X:\\web-homework\\lesson 11\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1639605104435},{"path":"X:\\web-homework\\lesson 11\\frontend\\node_modules\\vue-loader\\lib\\index.js","mtime":1639605107516}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBIZWFkZXIgZnJvbSAiLi9jb21wb25lbnRzL0hlYWRlciI7CmltcG9ydCBNaWRkbGUgZnJvbSAiLi9jb21wb25lbnRzL01pZGRsZSI7CmltcG9ydCBGb290ZXIgZnJvbSAiLi9jb21wb25lbnRzL0Zvb3RlciI7CmltcG9ydCBheGlvcyBmcm9tICJheGlvcyIKCgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ0FwcCcsCiAgY29tcG9uZW50czogewogICAgRm9vdGVyLAogICAgTWlkZGxlLAogICAgSGVhZGVyCiAgfSwKICBkYXRhOiBmdW5jdGlvbiAoKSB7CiAgICByZXR1cm4gewogICAgICB1c2VyOiBudWxsLAogICAgICBwb3N0czogW10KICAgIH0KICB9LAogIGJlZm9yZU1vdW50KCkgewogICAgaWYgKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJqd3QiKSAmJiAhdGhpcy51c2VyKSB7CiAgICAgIHRoaXMuJHJvb3QuJGVtaXQoIm9uSnd0IiwgbG9jYWxTdG9yYWdlLmdldEl0ZW0oImp3dCIpKTsKICAgIH0KICAgIGF4aW9zLmdldCgiL2FwaS8xL3Bvc3RzIikudGhlbihyZXNwb25zZSA9PiB7CiAgICAgIHRoaXMucG9zdHMgPSByZXNwb25zZS5kYXRhOwogICAgfSkKICB9LAogIGJlZm9yZUNyZWF0ZSgpIHsKICAgIHRoaXMuJHJvb3QuJG9uKCJvbkVudGVyIiwgKGxvZ2luLCBwYXNzd29yZCkgPT4gewogICAgICBpZiAocGFzc3dvcmQgPT09ICIiKSB7CiAgICAgICAgdGhpcy4kcm9vdC4kZW1pdCgib25FbnRlclZhbGlkYXRpb25FcnJvciIsICJQYXNzd29yZCBpcyByZXF1aXJlZCIpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgYXhpb3MucG9zdCgiL2FwaS8xL2p3dCIsIHsKICAgICAgICBsb2dpbiwgcGFzc3dvcmQKICAgICAgfSkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oImp3dCIsIHJlc3BvbnNlLmRhdGEpOwogICAgICAgIHRoaXMuJHJvb3QuJGVtaXQoIm9uSnd0IiwgcmVzcG9uc2UuZGF0YSk7CiAgICAgIH0pLmNhdGNoKGVycm9yID0+IHsKICAgICAgICB0aGlzLiRyb290LiRlbWl0KCJvbkVudGVyVmFsaWRhdGlvbkVycm9yIiwgZXJyb3IucmVzcG9uc2UuZGF0YSk7CiAgICAgIH0pOwogICAgfSk7CgogICAgdGhpcy4kcm9vdC4kb24oIm9uUmVnaXN0ZXIiLCAocmF3TG9naW4sIHJhd05hbWUsIHBhc3N3b3JkKSA9PiB7CiAgICAgICAgICBjb25zdCBsb2dpbiA9IHJhd0xvZ2luLnRyaW0oKTsKICAgICAgICAgIGNvbnN0IG5hbWUgPSByYXdOYW1lLnRyaW0oKTsKICAgICAgICAgIGlmIChwYXNzd29yZCA9PT0gIiIpIHsKICAgICAgICAgICAgdGhpcy4kcm9vdC4kZW1pdCgib25SZWdpc3RlclZhbGlkYXRpb25FcnJvciIsICJQYXNzd29yZCBpcyByZXF1aXJlZCIpOwogICAgICAgICAgICByZXR1cm4KICAgICAgICAgIH0KICAgICAgICAgIGF4aW9zLnBvc3QoIi9hcGkvMS91c2VycyIsIHsKICAgICAgICAgICAgbG9naW4sIHBhc3N3b3JkLCBuYW1lCiAgICAgICAgICB9KQogICAgICAgICAgICAgIC50aGVuKCgpID0+IHRoaXMuJHJvb3QuJGVtaXQoIm9uRW50ZXIiLCBsb2dpbiwgcGFzc3dvcmQpKQogICAgICAgICAgICAgIC5jYXRjaChlcnJvciA9PiB7CiAgICAgICAgICAgICAgICB0aGlzLiRyb290CiAgICAgICAgICAgICAgICAgICAgLiRlbWl0KCJvblJlZ2lzdGVyVmFsaWRhdGlvbkVycm9yIiwgZXJyb3IucmVzcG9uc2UuZGF0YSk7CiAgICAgICAgICAgICAgfSkKICAgICAgICB9CiAgICApCgogICAgdGhpcy4kcm9vdC4kb24oIm9uV3JpdGVQb3N0IiwgKHJhd1RpdGxlLCByYXdUZXh0KSA9PiB7CiAgICAgIGNvbnN0IHRleHQgPSByYXdUZXh0LnRyaW0oKTsKICAgICAgY29uc3QgdGl0bGUgPSByYXdUaXRsZS50cmltKCk7CiAgICAgIGF4aW9zLnBvc3QoIi9hcGkvMS9wb3N0cyIsIHsKICAgICAgICB0aXRsZSwgdGV4dCwKICAgICAgICBqd3Q6IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJqd3QiKQogICAgICB9KS50aGVuKCgpID0+IGF4aW9zLmdldCgiL2FwaS8xL3Bvc3RzIikudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgdGhpcy5wb3N0cyA9IHJlc3BvbnNlLmRhdGE7CiAgICAgICAgdGhpcy4kcm9vdC4kZW1pdCgib25DaGFuZ2VQYWdlIiwgIkluZGV4Iik7CiAgICAgIH0pKS5jYXRjaChlcnJvciA9PiB7CiAgICAgICAgdGhpcy4kcm9vdAogICAgICAgICAgICAuJGVtaXQoIm9uV3JpdGVQb3N0VmFsaWRhdGlvbkVycm9yIiwgZXJyb3IucmVzcG9uc2UuZGF0YSk7CiAgICAgIH0pCiAgICB9KTsKCiAgICB0aGlzLiRyb290LiRvbigib25BZGRDb21tZW50IiwgKHBvc3RJZCwgcmF3VGV4dCkgPT4gewogICAgICBjb25zdCB0ZXh0ID0gcmF3VGV4dC50cmltKCk7CiAgICAgIGNvbnN0IHVybCA9ICIvYXBpLzEvcG9zdHMvIiArIHBvc3RJZCArICIvY29tbWVudHMiCiAgICAgIGF4aW9zLnBvc3QodXJsLCB7CiAgICAgICAgdGV4dCwKICAgICAgICBqd3Q6IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJqd3QiKQogICAgICB9KS50aGVuKCgpID0+IGF4aW9zLmdldCh1cmwpLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgIHRoaXMuJHJvb3QuJGVtaXQoIm9uQWRkQ29tbWVudFN1Y2Nlc3MiLCByZXNwb25zZS5kYXRhLCBwb3N0SWQpOwogICAgICB9KSkuY2F0Y2goZXJyb3IgPT4gewogICAgICAgIHRoaXMuJHJvb3QKICAgICAgICAgICAgLiRlbWl0KCJvbkFkZENvbW1lbnRWYWxpZGF0aW9uRXJyb3IiLCBlcnJvci5yZXNwb25zZS5kYXRhKTsKICAgICAgfSkKICAgIH0pOwoKICAgIHRoaXMuJHJvb3QuJG9uKCJvbkp3dCIsIChqd3QpID0+IHsKICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oImp3dCIsIGp3dCk7CgogICAgICBheGlvcy5nZXQoIi9hcGkvMS91c2Vycy9hdXRoIiwgewogICAgICAgIHBhcmFtczogewogICAgICAgICAgand0CiAgICAgICAgfQogICAgICB9KS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICB0aGlzLnVzZXIgPSByZXNwb25zZS5kYXRhOwogICAgICAgIHRoaXMuJHJvb3QuJGVtaXQoIm9uQ2hhbmdlUGFnZSIsICJJbmRleCIpOwogICAgICB9KS5jYXRjaCgoKSA9PiB0aGlzLiRyb290LiRlbWl0KCJvbkxvZ291dCIpKQogICAgfSk7CgogICAgdGhpcy4kcm9vdC4kb24oIm9uTG9nb3V0IiwgKCkgPT4gewogICAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgiand0Iik7CiAgICAgIHRoaXMudXNlciA9IG51bGw7CiAgICB9KTsKCiAgfQp9Cg=="},{"version":3,"sources":["App.vue"],"names":[],"mappings":";;;;;;;;;AASA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA","file":"App.vue","sourceRoot":"src","sourcesContent":["<template>\n  <div id=\"app\">\n    <Header :user=\"user\"/>\n    <Middle :posts=\"posts\" :user=\"user\"/>\n    <Footer/>\n  </div>\n</template>\n\n<script>\nimport Header from \"./components/Header\";\nimport Middle from \"./components/Middle\";\nimport Footer from \"./components/Footer\";\nimport axios from \"axios\"\n\n\nexport default {\n  name: 'App',\n  components: {\n    Footer,\n    Middle,\n    Header\n  },\n  data: function () {\n    return {\n      user: null,\n      posts: []\n    }\n  },\n  beforeMount() {\n    if (localStorage.getItem(\"jwt\") && !this.user) {\n      this.$root.$emit(\"onJwt\", localStorage.getItem(\"jwt\"));\n    }\n    axios.get(\"/api/1/posts\").then(response => {\n      this.posts = response.data;\n    })\n  },\n  beforeCreate() {\n    this.$root.$on(\"onEnter\", (login, password) => {\n      if (password === \"\") {\n        this.$root.$emit(\"onEnterValidationError\", \"Password is required\");\n        return;\n      }\n\n      axios.post(\"/api/1/jwt\", {\n        login, password\n      }).then(response => {\n        localStorage.setItem(\"jwt\", response.data);\n        this.$root.$emit(\"onJwt\", response.data);\n      }).catch(error => {\n        this.$root.$emit(\"onEnterValidationError\", error.response.data);\n      });\n    });\n\n    this.$root.$on(\"onRegister\", (rawLogin, rawName, password) => {\n          const login = rawLogin.trim();\n          const name = rawName.trim();\n          if (password === \"\") {\n            this.$root.$emit(\"onRegisterValidationError\", \"Password is required\");\n            return\n          }\n          axios.post(\"/api/1/users\", {\n            login, password, name\n          })\n              .then(() => this.$root.$emit(\"onEnter\", login, password))\n              .catch(error => {\n                this.$root\n                    .$emit(\"onRegisterValidationError\", error.response.data);\n              })\n        }\n    )\n\n    this.$root.$on(\"onWritePost\", (rawTitle, rawText) => {\n      const text = rawText.trim();\n      const title = rawTitle.trim();\n      axios.post(\"/api/1/posts\", {\n        title, text,\n        jwt: localStorage.getItem(\"jwt\")\n      }).then(() => axios.get(\"/api/1/posts\").then(response => {\n        this.posts = response.data;\n        this.$root.$emit(\"onChangePage\", \"Index\");\n      })).catch(error => {\n        this.$root\n            .$emit(\"onWritePostValidationError\", error.response.data);\n      })\n    });\n\n    this.$root.$on(\"onAddComment\", (postId, rawText) => {\n      const text = rawText.trim();\n      const url = \"/api/1/posts/\" + postId + \"/comments\"\n      axios.post(url, {\n        text,\n        jwt: localStorage.getItem(\"jwt\")\n      }).then(() => axios.get(url).then(response => {\n        this.$root.$emit(\"onAddCommentSuccess\", response.data, postId);\n      })).catch(error => {\n        this.$root\n            .$emit(\"onAddCommentValidationError\", error.response.data);\n      })\n    });\n\n    this.$root.$on(\"onJwt\", (jwt) => {\n      localStorage.setItem(\"jwt\", jwt);\n\n      axios.get(\"/api/1/users/auth\", {\n        params: {\n          jwt\n        }\n      }).then(response => {\n        this.user = response.data;\n        this.$root.$emit(\"onChangePage\", \"Index\");\n      }).catch(() => this.$root.$emit(\"onLogout\"))\n    });\n\n    this.$root.$on(\"onLogout\", () => {\n      localStorage.removeItem(\"jwt\");\n      this.user = null;\n    });\n\n  }\n}\n</script>\n\n<style>\n#app {\n\n}\n</style>\n"]}]}